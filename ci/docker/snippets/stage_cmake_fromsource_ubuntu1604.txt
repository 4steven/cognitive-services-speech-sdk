RUN DEBIAN_FRONTEND=noninteractive \
    apt-get update --quiet || true

RUN DEBIAN_FRONTEND=noninteractive \
    apt-get install --quiet --yes --no-install-recommends \
        wget \
        ca-certificates

RUN DEBIAN_FRONTEND=noninteractive \
    apt-get install --quiet --yes --no-install-recommends \
        build-essential

# Override at docker build time, as appropriate:
ARG CMAKE_VERSION=3.12.4

RUN export DEBIAN_FRONTEND=noninteractive && \
    apt-get update --quiet || true && \
    apt-get install --quiet --yes --no-install-recommends \
        wget \
        ca-certificates \
        build-essential \
        && \
    apt-get autoremove --quiet --yes && \
    rm -rf /var/lib/apt/lists/* && \
    CMAKE_MAJOR_MINOR=$(echo $CMAKE_VERSION | cut -d. -f1-2) && \
    CMAKE_BASE_NAME=cmake-$CMAKE_VERSION && \
    wget --no-verbose --output-document - https://cmake.org/files/v$CMAKE_MAJOR_MINOR/$CMAKE_BASE_NAME.tar.gz | \
        tar -xzf - && \
    cd $CMAKE_BASE_NAME && \
    ./bootstrap -- -DCMAKE_BUILD_TYPE:STRING=Release && \
    make -j $(nproc) && \
    make install && \
    cd .. && \
    rm -rf $CMAKE_BASE_NAME

